---
title: "Mini Data Analysis Milestone 2_TB"
author: "Tiana Broen, 16922171"
date: "19/10/2021"
output: github_document
---

## Load dataset and tidyverse package
```{r, message = FALSE}
library(datateachr) #Contains the dataset I have picked for this project ("apt_buildings")
library(tidyverse)
```
# Task 1: Process and summarize your data

## 1.1: Write the 4 research questions you defined in milestone 1.
The four research questions I have chosen to explore using the "apt_buildings" dataset are:
1. *What property type (i.e. private, TCHC, Social Housing) is most likely to allow pets?*
2. *Is there a relationship between the accessibility of apartments and the year they were built?*
3. *What property type (i.e. private, TCHC, Social Housing) would be most appropriate for a family (i.e. including child play area, parking, guest parking, laundry room, and storage)*
4. *Are apartments that allow pets also more likely to offer parking?*

## 1.2: Choose one task from **Summarizing** and one task from **Graphing** to complete for each of my four research questions.

### Research Question #1: "What property type is most likely to allow pets?"
**Task 4:**: Based on two categorical variables, calculate two summary statistics of your choosing.
```{r}
# I am interested in summary statistics for the "pets_allowed" and "property_type" categorical variables.
apt_buildings %>% group_by(pets_allowed) %>%
  summarise(count=n()) #In total, 601 buildings do not allow pets, 2764 buildings allow pets, and 90 do not specify whether or not they allow pets.

apt_buildings %>% group_by(property_type) %>%
  summarise(count=n()) #In total, 2888 buildings are private properties, 240 buildings are social housing properties, and 327 are TCHC properties (Toronto Community Housing Corporation)

apt_buildings %>% group_by(pets_allowed, property_type) %>%
  summarise(count=n()) #This tells me how many buildings allow pets based on the property type. Based on this summary, the majority of pet friendly buildings are private properties. However, social housing properties offer the highest percentage of pet-friendly properties (86% of social housing properties are pet-friendly; 84% of TCHC properties are pet-friendly; 79% of private propterties are pet-friendly).
```

**Task 5:* Create a graph out of summarized variables that has at least two geom layers.
```{r}
pets_property <- apt_buildings %>% group_by(property_type, pets_allowed) %>%
  mutate(count=n())

reshape2::pets_property %>%
  ggplot(aes(property_type, count, fill=pets_allowed)  +
  stat_summary(geom = "bar", position = position_stack())
  
counts <- table(apt_buildings$property_type, apt_buildings$pets_allowed)
barplot(counts, main="Number of Pets Allowed by Property Type",
  xlab="Pets Allowed?", ylab="Number of Buildings", col=c("darkblue","red", "yellow"),
  legend = rownames(counts), beside=TRUE)
```

### Research Question #2: "Is there a relationship between the accessibility of apartments and the year they were built?"
**Task 1:**: Compute the *range*, *mean*, and *two other summary statistics* of **one numerical variable** across the groups of **one categorical variable** from your data.
```{r}
# Creating a subset of data for buildings with barrier free accessibility entrances.
accessible <- apt_buildings %>% 
  filter(barrier_free_accessibilty_entr == "YES")

# Calculating range, mean, meadian, and sd of the years that buildings with barrier free accessibility entrances were built.
summary(accessible$year_built)
sd(accessible$year_built, na.rm=TRUE)
```

**Task 7:**: Make a graph where it makes sense to customize the alpha transparency.
```{r}
apt_buildings %>%
  ggplot(aes(barrier_free_accessibilty_entr, year_built)) + geom_point(alpha=.1) + #'aplha=.1' adjusts the opacity so you can see more data points.
  theme_minimal() + ylab("Year Built") + xlab("Accessible entrance?") # 13 rows containing 'NA' values were deleted.
```

### Research Question #3: "What property type (i.e. private, TCHC, Social Housing) would be most appropriate for a family (i.e. including child play area, parking, guest parking, laundry room, and storage)?"
**Task 4:** Based on two categorical variables, calculate two summary statistics of your choosing.
```{r}
apt_buildings %>% group_by(laundry_room) %>% #Number of buildings with laundry
  summarise(count=n())
apt_buildings %>% group_by(amenities) %>% #Number of buildings with different amenities
  summarise(count=n())

summary(apt_buildings$no_of_accessible_parking_spaces) #Figuring out the average number of accessible parking spaces available in all buildings.
sd(apt_buildings$no_of_accessible_parking_spaces, na.rm=TRUE)
```

**Task 8:** Create 3 histograms out of summarized variables, with each histogram having different sized bins. Pick the "best" one and explain why it is the best.
```{r}
ggplot(apt_buildings, aes(no_of_accessible_parking_spaces)) +
  geom_histogram(bins = 15) #This is the best histogram as it gives a clear visual of the range of number of parkings spaces without creating a messy or confusing plot (i.e. the third histogram shows too many bars and makes the data look extremely skewed)

ggplot(apt_buildings, aes(no_of_accessible_parking_spaces)) +
  geom_histogram(bins = 5)

ggplot(apt_buildings, aes(no_of_accessible_parking_spaces)) +
  geom_histogram(bins = 50) 
```

### Research Question #4: "Are apartments that allow pets also more likely to offer parking?"
**Task 4:** Based on two categorical variables, calculate two summary statistics of your choosing.
```{r}
apt_buildings %>% group_by(pets_allowed) %>%
  summarise(count=n())
apt_buildings %>% group_by(parking_type) %>%
  summarise(count=n())
```

**Task 7:** Make a graph where it makes sense to customize the alpha transparency.
```{r}

```

**Summarizing:**

1. Compute the *range*, *mean*, and *two other summary statistics* of **one numerical variable** across the groups of **one categorical variable** from your data.
2. Compute the number of observations for at least one of your categorical variables. Do not use the function `table()`!
3. Create a categorical variable with 3 or more groups from an existing numerical variable. You can use this new variable in the other tasks! *An example: age in years into "child, teen, adult, senior".*
4. Based on two categorical variables, calculate two summary statistics of your choosing.

**Graphing:**

5. Create a graph out of summarized variables that has at least two geom layers.
6. Create a graph of your choosing, make one of the axes logarithmic, and format the axes labels so that they are "pretty" or easier to read. 
7. Make a graph where it makes sense to customize the alpha transparency.
8. Create 3 histograms out of summarized variables, with each histogram having different sized bins. Pick the "best" one and explain why it is the best.

Make sure it's clear what research question you are doing each operation for!

<!------------------------- Start your work below ----------------------------->


<!----------------------------------------------------------------------------->

### 1.3
Based on the above operations, I have definitely become closer to answering my research questions. Specifically, I was able to better visualize answers to my questions using ggplot2. Specifically, after completing the activities for my second question, I realized that this was quite an easy question to answer. I will further refine this question by adding another variable to understand the types of ammenities available at accessible buildings (i.e. buildings with barrier free access entrances). I found the results from my first question ("What property type is most likely to allow pets?") interesting because although private properties offer the highest number of pet friendly buildings, social housing properties are actually the most likely property types to offer pet-friendly housing. This may be counter-intuitive if you were just to look at the raw data and not explore the research question further.

# Task 2: Tidy your data (12.5 points)

In this task, we will do several exercises to reshape our data. The goal here is to understand how to do this reshaping with the `tidyr` package.

A reminder of the definition of *tidy* data:

- Each row is an **observation**
- Each column is a **variable**
- Each cell is a **value**

*Tidy'ing* data is sometimes necessary because it can simplify computation. Other times it can be nice to organize data so that it can be easier to understand when read manually. 

### 2.1 (2.5 points)

Based on the definition above, can you identify if your data is tidy or untidy? Go through all your columns, or if you have >8 variables, just pick 8, and explain whether the data is untidy or tidy.

<!--------------------------- Start your work below --------------------------->


<!----------------------------------------------------------------------------->

### 2.2 (5 points)

Now, if your data is tidy, untidy it! Then, tidy it back to it's original state.

If your data is untidy, then tidy it! Then, untidy it back to it's original state.

Be sure to explain your reasoning for this task. Show us the "before" and "after".

<!--------------------------- Start your work below --------------------------->


<!----------------------------------------------------------------------------->

### 2.3 (5 points)

Now, you should be more familiar with your data, and also have made progress in answering your research questions. Based on your interest, and your analyses, pick 2 of the 4 research questions to continue your analysis in milestone 3, and explain your decision. 

Try to choose a version of your data that you think will be appropriate to answer these 2 questions in milestone 3. Use between 4 and 8 functions that we've covered so far (i.e. by filtering, cleaning, tidy'ing, dropping irrelvant columns, etc.). 

<!--------------------------- Start your work below --------------------------->


<!----------------------------------------------------------------------------->

*When you are done, knit an `md` file. This is what we will mark! Make sure to open it and check that everything has knitted correctly before submitting your tagged release.*